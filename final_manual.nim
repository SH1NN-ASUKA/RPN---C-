# 导入 Nimib 核心模块，确保加载所有功能
import nimib

# 关键：手动初始化 nb 对象（适配 0.3.12 版本的底层逻辑）
var nb = initNbDoc()

# --- 文档内容开始（所有命令都用 nb.xxx 格式）---
# 标题（h1 方法）
nb.h1("RPN 计算器使用说明书")

# 1. 安装与编译指南（h2 方法）
nb.h2("1. 安装与编译指南")
# 段落（p 方法）
nb.p("本计算器基于 C++ 开发，需以下环境支持：")
# 列表（list 方法）
nb.list([
  "Ubuntu 20.04+/Debian 11+ 系统",
  "GCC 9.0+ 编译器",
  "Nim 1.6.14（用于生成本文档）"
])

nb.p("### 编译步骤：")
# 代码块（codeBlock 方法）
nb.codeBlock("bash", """
# 1. 进入项目目录
cd ~/rpn_calc

# 2. 编译 C++ 代码
g++ rpn_calc.cpp -o rpn_calc -std=c++11

# 3. 运行计算器
./rpn_calc
""")

# 2. 基本使用示例
nb.h2("2. 基本使用示例")
# 表格（table 方法）
nb.table(["命令", "说明", "示例"], [
  ["RPN 表达式", "输入后缀表达式计算", "`10 2 3 + *` → 结果：50"],
  "clear", "清空当前操作数栈", "`clear` → 提示“栈已清空”",
  "stack", "查看当前栈状态", "`stack` → 显示“当前栈（栈底→栈顶）：50”",
  "history", "查看计算历史记录", "`history` → 列出所有输入和结果",
  "q", "退出计算器程序", "`q` → 提示“退出计算器”"
])

# 3. 支持的操作说明
nb.h2("3. 支持的操作说明")
nb.h3("3.1 基础运算操作符")
nb.table(["操作符", "功能", "示例"], [
  "+", "两数相加（a + b）", "`5 3 +` → 8",
  "-", "两数相减（a - b）", "`5 3 -` → 2",
  "*", "两数相乘（a * b）", "`5 3 *` → 15",
  "/", "两数相除（a / b，禁止除零）", "`6 2 /` → 3"
])

nb.h3("3.2 高级操作符")
nb.table(["操作符", "功能", "示例"], [
  "fib", "计算斐波那契数列第 n 项", "`5 fib` → 5（数列：1,1,2,3,5）"
])

# 4. 错误类型与处理
nb.h2("4. 错误类型与处理")
nb.table(["错误提示", "触发场景", "解决方案"], [
  "除零错误", "除法操作中除数为 0（如 `4 0 /`）", "确保除数不为 0",
  "栈元素不足", "操作符所需操作数不够（如直接输入 `+`）", "补充输入数字",
  "无效输入", "输入非数字/非操作符（如 `5 a +`）", "检查输入格式",
  "表达式不完整", "输入未结束（如 `5 3 + 4`）", "补充操作符或数字"
])

# 5. 完整使用示例
nb.h2("5. 完整使用示例")
nb.codeBlock("bash", """
=== C++ RPN 计算器 ===
命令：1. 输入表达式（如 5 3 +） 2. clear（清空栈） 3. stack（看栈）
      4. history（看历史） 5. q（退出）
======================
> 10 2 3 + *
结果：50
> stack
当前栈（栈底→栈顶）：50.000000
> 5 fib
结果：5.000000
> history
=== 计算历史 ===
1. 10 2 3 + * = 50.000000
2. 5 fib = 5.000000
> clear
栈已清空
> q
退出计算器
""")

# --- 文档内容结束 ---

# 保存 HTML 文件（用 nb 对象的 save 方法，适配旧版本）
nb.save("rpn_manual.html")

